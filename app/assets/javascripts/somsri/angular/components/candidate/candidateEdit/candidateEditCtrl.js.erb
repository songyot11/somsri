(function() {
  'use strict';
  angular.module('somsri.somsri.candidateEdit', [])
  .controller('candidateEditCtrl', ['$scope', '$rootScope', 'candidateEditService', '$state', function($scope, $rootScope, candidateEditService, $state) {
    var ctrl = this;
    ctrl.files = [{ file: "" }]
    var imagefile;

    $rootScope.loadAndAuthorizeResource("candidateEdit", function(){
      candidateEditService.getCandidate($state.params.id).then(function(resp) {
        ctrl.data = resp;
        console.log(ctrl.data)
        console.log(ctrl.data.programming_skills_attributes);
      });

    ctrl.submit = function(params){
    ctrl.uploadPhoto();
    candidateEditService.saveCandidate(ctrl.data.id, params).then(function(resp){
    console.log(params)
            console.log('Update complete!'); 
      });
  };

  ctrl.uploadPhoto = function() {
    candidateEditService.uploadImage(ctrl.data.id, imagefile).then(function(resp) {
      console.log('Upload Success!');
    });
    }


  ctrl.showImage = function(event, id){
    console.log(event.target.files[0]);
    var img = URL.createObjectURL(event.target.files[0]);
    $('#' + id).attr('src', img);
    imagefile = event.target.files[0];
  }

  ctrl.addFile = function(){
    ctrl.files.push({ file: "" });
    console.log(ctrl.files)
  }

  ctrl.addProgrammingskill = function(){
    ctrl.data.programming_skills_attributes.push({ skill_name: "", skill_point: "" });
  }

  ctrl.addSoftskill = function(){
    ctrl.data.soft_skills_attributes.push({ skill_name: "", skill_point: "" });
  }

  ctrl.addDesignskill = function(){
    ctrl.data.design_skills_attributes.push({ skill_name: "", skill_point: "" });
  }

  $scope.points = [1,2,3,4,5];







    });

  }]);
})();
